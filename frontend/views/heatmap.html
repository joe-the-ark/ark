<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8"/>
    <link rel="icon" href="/static/images/favicon.ico"/>
    <meta name="viewport" content="width=device-width, initial-scale=1, minimum-scale=1, maximum-scale=1"/>
    <meta name="theme-color" content="#51ceec"/>
    <meta name="description" content="ARK"/>
    <title>Team-HEATMAP</title>
    <link rel="stylesheet" href="/static/css/app.css">
    <link rel="stylesheet" href="/static/css/heatmap.css">


</head>
<body>
  <div class="app">
    <div class="app__head">
        <header class="header-main container">
            <div class="header-main__title">
                <span class="icon-logo"></span>
                <span>THE ARK</span>
            </div>
            <div class="header-main__user">
                <div class="user">
                    <div class="user__subtitle">
                        {{game.name}}
                    </div>
                    <img src="{{user.avatar}}" alt="">
                    <div class="user__title">
                        {{user.name}}
                    </div>
                </div>
            </div>
            <div class="header-main__progress">
                <div class="progress">
                    <label>Mirror</label>
                    <div class="progress__bar">
                        <div style="width: 100%">100%</div>
                    </div>
                </div>
            </div>
        </header>
    </div>
    <div class="app__body" id="app-1">
        <div class="container">
          <h1>Team Heatmap</h1>
          <p class="text">Diese Übersicht eignet sich für Trainer und professionelle Prozessbegleiter. Die Teammap bietet eine aggregierte Auswertung aller Spannungen im Team. Insbesondere um gruppendynamische Muster wie Übertragungen, Projektionen, destruktiv wirkendes narzistisches Verhalten und Sündenbockdynamiken zu erkennen.</p>
        </div>
        <div class="heatmap">

          <div class="main-column left">
            <div class="corner"></div>
            <div class="corner"></div>
            <div class="heat_value average_by_players" v-for="value in row0">[[ value ]]</div>

            <div class="corner"></div>
          </div>
          <div class="main-column player" v-for="user in main_map">
            <div class="heat_value over_player">[[ user[0] ]]</div>
            <div class="heat_player">
              <div class="name">[[ user[1] ]]</div>
              <img :src="user[2]" alt="">
            </div>
            <div v-for="value in user[3]" v-bind:class="{ 'heat_value one': value[1]==='yellow', 'heat_value two': value[1]==='black', 'heat_value three': value[1]==='None', 'heat_value four': value[1]==='red' }">[[ keepTwoDecimal(value[0]) ]]</div>

            <div class="heat_value average-by-player">[[ user[4] ]]</div>
          </div>
          <div class="main-column prop">
            <div class="corner"></div>
            <div class="corner"></div>
            <div class="property" v-for="scale in scale_list">
              <p class="property_one">[[ scale[0] ]]</p>
              <p class="property_two">[[ scale[1] ]]</p>
            </div>
            <div class="corner"></div>
          </div>
          <div class="main-column right">
            <div class="corner"></div>
            <div class="corner"></div>           
              <div class="heat_value property_value" v-for="value in scale_value_list">[[ value ]]</div>          
            <div class="corner"></div>
          </div>


        </div>
    </div>
  </div>

  <script src="/static/vue.js"></script>
  <script src="/static/axios.min.js"></script>
  <script>
  var app_ = new Vue({
    delimiters: ['[[', ']]'],
    el: '#app-1',
    data:{
      row0: {{ row0|safe }},
      main_map: {{ main_map|safe }},
      scale_list: {{ scale_list|safe }},
      scale_value_list: {{ scale_value_list|safe }}
    },
    methods:{
      keepTwoDecimal(num) {  
        var result = parseFloat(num);  
        if (isNaN(result)) {  
          alert('error, please check！');  
            return false;  
          }  
          result = Math.round(num * 100) / 100;  
          return result;  
       },
    }
  })
  let playersCount = {{user_number}};; 
  let heatmapEl = document.querySelector('.heatmap');
  heatmapEl.style.gridTemplateColumns = `[lft] minmax(50px, 100px) repeat(${playersCount}, minmax(50px, 100px)) [prop] 150px [rght] minmax(50px, 100px) `

  </script>
  <div class="container">
          <h1>Die Farbcodes sind aus dem Spiel bekannt:</h1>
      <p class="text"><b>WEISS</b> = Selbst- und Fremdbild in der Safe Zone; <b>GELB</b> = Fremdwahrnehmung ausserhalb der Safe Zone; <b>ROT</b> = Selbstwahrnehmung ausserhalb der Safe Zone; <b>SCHWARZ</b> = Selbst- und Fremdwahrnehmung ausserhalb der SAFE ZONE.</p>
        </div>

</body>
</html>
